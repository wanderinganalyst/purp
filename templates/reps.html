{% extends 'base.html' %}

{% block title %}Representatives - BecauseImStuck{% endblock %}

{% block additional_styles %}
  .rep-card {
    border: 1px solid rgba(138, 43, 226, 0.2);
    border-top: 4px solid var(--light-purple);
    transition: all 0.3s ease;
    height: 100%;
  }
  .rep-card:hover {
    border-top-color: var(--royal-purple);
    background: rgba(138, 43, 226, 0.05);
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(138, 43, 226, 0.2) !important;
  }
  .rep-name {
    color: #000000;
    text-decoration: none;
    font-weight: 600;
  }
  .rep-card .stretched-link {
    text-decoration: none;
  }
  .bill-badge {
    background: var(--pale-purple);
    color: var(--deep-purple);
    border-radius: 4px;
    padding: 4px 10px;
    font-size: 0.8rem;
    font-weight: 500;
  }
{% endblock %}

{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-4">
    <div>
      <h1 class="h2 mb-1" style="color: var(--royal-purple);">
        <i class="bi bi-people-fill"></i> Missouri House Representatives
      </h1>
      <p class="text-muted mb-0">View members and their sponsored bills</p>
    </div>
    <div>
      <span class="badge" style="background: var(--light-purple); font-size: 0.9rem;">
        {{ members|length if members else 0 }} Members
      </span>
    </div>
  </div>

  {% if members %}
    <div class="row g-3">
      {% for m in members %}
        <div class="col-sm-6 col-md-4 col-lg-3">
          <div class="card rep-card shadow-sm">
            <div class="card-body">
              <h5 class="card-title mb-3">
                <a class="rep-name stretched-link" href="{{ url_for('reps.rep_detail', district=m.district) }}">
                  <i class="bi bi-person-badge-fill"></i> {{ m.name }}
                </a>
              </h5>
              {% if m.sponsored_bills %}
                <div class="mb-0">
                  <p class="text-muted small mb-2">
                    <i class="bi bi-file-earmark-text"></i> Recent Bills:
                  </p>
                  <ul class="list-unstyled mb-0">
                    {% for bill in m.sponsored_bills[:3] %}
                      <li class="border-top pt-2 pb-2">
                        <a href="{{ url_for('bills.bill_detail', bill_id=(bill.number if bill.number else bill.id)) }}" class="text-decoration-none">
                          <span class="bill-badge">
                            {{ bill.number if bill.number else bill.id }}
                          </span>
                        </a>
                        {% if bill.title %}
                          <small class="text-muted d-block mt-1">{{ bill.title[:60] }}{% if bill.title|length > 60 %}...{% endif %}</small>
                        {% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                  {% if m.sponsored_bills|length > 3 %}
                    <small class="text-muted">
                      <i class="bi bi-plus-circle"></i> {{ m.sponsored_bills|length - 3 }} more
                    </small>
                  {% endif %}
                </div>
              {% else %}
                <p class="text-muted mb-0 small">
                  <i class="bi bi-dash-circle"></i> No sponsored bills
                </p>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-custom">
      <i class="bi bi-info-circle-fill"></i> No members found or remote fetch failed.
    </div>
  {% endif %}
{% endblock %}
