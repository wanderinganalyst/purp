{% extends 'base.html' %}

{% block title %}{{ message.subject }} - Purp{% endblock %}

{% block content %}
  <div class="mb-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <a href="{{ url_for('messages.inbox') }}" class="btn btn-sm btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back to Messages
      </a>
      <form method="post" 
            action="{{ url_for('messages.delete_message', message_id=message.id) }}"
            style="display: inline;"
            onsubmit="return confirm('Are you sure you want to delete this message?');">
        <button type="submit" class="btn btn-sm btn-outline-danger">
          <i class="bi bi-trash"></i> Delete Message
        </button>
      </form>
    </div>
    
    <div class="card shadow-sm" style="border-left: 4px solid var(--light-purple);">
      <div class="card-header" style="background: var(--pale-purple);">
        <h3 class="mb-0" style="color: var(--deep-purple);">{{ message.subject }}</h3>
      </div>
      <div class="card-body">
        <!-- Message Metadata -->
        <div class="mb-4 pb-3" style="border-bottom: 1px solid var(--pale-purple);">
          <div class="row">
            <div class="col-md-6">
              <p class="mb-2">
                <strong><i class="bi bi-person-fill"></i> To:</strong> {{ message.recipient_rep_name }}
              </p>
              <p class="mb-2">
                <strong><i class="bi bi-geo-alt-fill"></i> District:</strong> {{ message.recipient_rep_district }}
              </p>
            </div>
            <div class="col-md-6 text-md-end">
              <p class="mb-2">
                <strong><i class="bi bi-tag-fill"></i> Type:</strong> 
                <span class="badge" style="background: var(--royal-purple);">
                  {{ message.recipient_type.capitalize() }}
                </span>
              </p>
              <p class="mb-2">
                <strong><i class="bi bi-clock-fill"></i> Sent:</strong> 
                {{ message.sent_at.strftime('%B %d, %Y at %I:%M %p') }}
              </p>
            </div>
          </div>
        </div>

        <!-- Message Content -->
        <div class="message-content" style="white-space: pre-wrap; line-height: 1.6;">
{{ message.content }}
        </div>
      </div>
      <div class="card-footer" style="background: #f8f9fa;">
        <small class="text-muted">
          <i class="bi bi-info-circle"></i> This message has been recorded in your message history. 
          For direct responses, please contact your representative's office directly.
        </small>
      </div>
    </div>
  </div>
{% endblock %}
